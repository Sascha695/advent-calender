<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Adventskalender Tag 5 ‚Äì Sudoku</title>
  <link rel="stylesheet" href="style.css">

  <style>
    /* ===== Variables (hier anpassen) ===== */
    :root{
      background: url('assets/lock.png'); /* Hintergrundbild */
      --glass-opacity: 0.28;              /* 0..1: Transparenz der Karte */
      --glass-blur: 14px;                 /* Unsch√§rfe der Glas-Karte */
      --card-max-width: 900px;            /* Max-Breite der Karte */
      --accent: #1d9e57;                  /* Buttonfarbe */
    }

    /* ===== Seite mit Hintergrundbild ===== */
    html, body { height: 100%; }
    body{
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      
      no-repeat center center fixed;
      background-size: cover;
      color: #222;
      background-position: center 50px; /* 50 px weiter nach unten */
    }

    /* ===== Header ===== */
    header{
      text-align: center;
      color: #fff;
      text-shadow: 0 2px 10px rgba(0,0,0,.35);
      padding: 1rem 1rem .5rem;
    }
    header h1{ margin: .2rem 0 1rem; }

    /* ===== puzzle-container: externe wei√üe Karte aus style.css neutralisieren ===== */
    main.puzzle-container{
      background: transparent !important;
      box-shadow: none !important;
      border: 0 !important;
      border-radius: 0 !important;
      padding: 0 !important;
      max-width: var(--card-max-width);
      margin: 0 auto 3rem;
    }

    /* ===== Glas-Karte ===== */
    .glass-card{
      background: rgba(255,255,255,var(--glass-opacity));
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      border: 1px solid rgba(0,0,0,.08);
      padding: 1.25rem;
      margin: 0 1rem; /* etwas Seitenluft auf Handy */
    }
    .glass-card p{ margin: 0 0 1rem; }

    /* ===== Sudoku-Grid (9√ó9) ===== */
    .sudoku{
      width: min(92vw, 520px);
      aspect-ratio: 1/1;
      margin: .75rem auto 0;
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      grid-template-rows: repeat(9, 1fr);
      border: 4px solid #000;
      border-radius: 10px;
      overflow: hidden;
      background: rgba(255,255,255,0.12);
    }
    .cell{ border: 1px solid #000; position: relative; }
    /* dicke Linien f√ºr 3√ó3-Bl√∂cke */
    .cell[data-c="0"], .cell[data-c="3"], .cell[data-c="6"] { border-left-width: 3px; }
    .cell[data-r="0"], .cell[data-r="3"], .cell[data-r="6"] { border-top-width: 3px; }
    .cell[data-c="8"] { border-right-width: 3px; }
    .cell[data-r="8"] { border-bottom-width: 3px; }

    .prefilled, .cell input{
      width: 100%; height: 100%;
      display: grid; place-items: center;
      font: 600 1.15rem/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: transparent; color:#222;
    }
    .prefilled{ color:#111; }
    .cell input{
      text-align: center; border: none; outline: none;
      -moz-appearance: textfield;
    }
    .cell input::-webkit-outer-spin-button,
    .cell input::-webkit-inner-spin-button{ -webkit-appearance: none; margin: 0; }
    .cell input:focus{ box-shadow: inset 0 0 0 2px rgba(0,0,0,.25); }

    .error{ background: rgba(255,0,0,.16)!important; }
    .ok{ background: rgba(30,200,0,.12)!important; }

    /* ===== Buttons & Feedback ===== */
    .actions{
      display: flex; justify-content: center; align-items: center;
      gap: .75rem; margin-top: .9rem;
    }
    .btn{
      appearance: none; border: none; cursor: pointer;
      background: var(--accent); color:#fff;
      padding: .6rem 1rem; border-radius: 10px;
      font-weight: 600; box-shadow: 0 3px 10px rgba(0,0,0,.2);
    }
    #sudokuMsg{ color:#222; }

    /* ===== Buchstabenanzeige ===== */
    .letter-container{ margin-top: 1rem; text-align: center; }
    .letter{
      display:inline-block; min-width:2.5rem;
      padding:.4rem .8rem; font-weight:800; font-size:1.2rem;
      background:#fff; color:#111; border-radius:10px;
      box-shadow:0 2px 8px rgba(0,0,0,.18);
    }
  </style>
</head>
<body>
  <header>
    <h1>Tag&nbsp;5 ‚Äì Sudoku</h1>
  </header>

  <main class="puzzle-container">
    <div class="glass-card">
      <p>Die Elfen haben leider den Schl√ºssel zur Geschenkefabrik verloren ‚Äì kurz vor Weihnachten! Das Schloss ist mit einem Zahlenr√§tsel versehen. Kannst du das Sudoku l√∂sen, damit die Produktion weiterlaufen kann?</p>

      <!-- Sudoku -->
      <div id="sudoku" class="sudoku"></div>

      <!-- Aktionen/Feedback -->
      <div class="actions">
        <button type="button" class="btn" onclick="checkSudoku()">√úberpr√ºfen</button>
        <span id="sudokuMsg"></span>
      </div>

      <!-- Buchstabe -->
      <div id="letter-container" class="letter-container" style="display:none;">
        <p>Dein Buchstabe:</p>
        <div class="letter" id="letter"></div>
        <p>Merke dir diesen Buchstaben!</p>
      </div>
    </div>
  </main>

  <script>
    /* ===== 1) Puzzle (0 = leer) ===== */
    const puzzle = [
      [0,0,7,0,9,0,3,0,0],
      [0,6,8,0,0,0,9,2,0],
      [0,3,0,0,2,0,1,0,8],
      [0,7,0,0,9,0,2,4,0],
      [3,0,0,0,0,5,0,0,0],
      [5,9,0,0,0,7,0,0,0],
      [0,0,0,0,2,0,0,9,0],
      [8,0,0,0,5,0,4,0,0],
      [0,1,0,0,4,0,6,0,0],
    ];

    /* ===== 2) Rendering ===== */
    const root = document.getElementById('sudoku');
    const inputs = [];
    for (let r=0;r<9;r++){
      inputs[r]=[];
      for (let c=0;c<9;c++){
        const cell=document.createElement('div');
        cell.className='cell'; cell.dataset.r=r; cell.dataset.c=c;
        if (puzzle[r][c]!==0){
          const s=document.createElement('div');
          s.className='prefilled'; s.textContent=puzzle[r][c];
          cell.appendChild(s); inputs[r][c]=null;
        } else {
          const inp=document.createElement('input');
          inp.inputMode='numeric'; inp.maxLength=1;
          inp.addEventListener('input',(e)=>{
            const v=e.target.value.replace(/[^1-9]/g,'');
            e.target.value=v.slice(0,1);
          });
          cell.appendChild(inp); inputs[r][c]=inp;
        }
        root.appendChild(cell);
      }
    }

    /* ===== 3) Solver ===== */
    function solve(grid){
      const findEmpty=()=>{for(let r=0;r<9;r++)for(let c=0;c<9;c++)if(grid[r][c]===0)return[r,c];return null;};
      const isSafe=(r,c,val)=>{
        for(let i=0;i<9;i++) if(grid[r][i]===val||grid[i][c]===val) return false;
        const br=Math.floor(r/3)*3, bc=Math.floor(c/3)*3;
        for(let i=0;i<3;i++) for(let j=0;j<3;j++) if(grid[br+i][bc+j]===val) return false;
        return true;
      };
      const step=()=>{
        const pos=findEmpty(); if(!pos) return true;
        const [r,c]=pos;
        for(let v=1;v<=9;v++){
          if(isSafe(r,c,v)){ grid[r][c]=v; if(step()) return true; grid[r][c]=0; }
        }
        return false;
      };
      return step();
    }

    /* ===== 4) Pr√ºfen & Feedback ===== */
    function readUserGrid(){
      const g=puzzle.map(row=>row.slice());
      for(let r=0;r<9;r++) for(let c=0;c<9;c++){
        if(puzzle[r][c]===0){
          const v=inputs[r][c].value?parseInt(inputs[r][c].value,10):0;
          g[r][c]=v;
        }
      }
      return g;
    }

    function checkSudoku(){
      const solution=puzzle.map(row=>row.slice());
      if(!solve(solution)){
        document.getElementById('sudokuMsg').textContent='Dieses Sudoku ist nicht l√∂sbar.';
        return;
      }
      const user=readUserGrid();
      let allFilled=true, allCorrect=true;

      for(let r=0;r<9;r++) for(let c=0;c<9;c++){
        const cellDiv=root.children[r*9+c];
        cellDiv.classList.remove('error','ok');
        if(puzzle[r][c]===0){
          const val=user[r][c];
          if(val===0) allFilled=false;
          if(val!==0 && val!==solution[r][c]){ allCorrect=false; cellDiv.classList.add('error'); }
          else if(val!==0){ cellDiv.classList.add('ok'); }
        }
      }

      const msg=document.getElementById('sudokuMsg');
      if(allCorrect && allFilled){
        msg.style.color='green'; msg.textContent='üéâ Richtig gel√∂st!';
        showLetter('E');
      } else if(!allFilled){
        msg.style.color='#222'; msg.textContent='Es sind noch Felder leer ‚Äì weiterknobeln üòä';
      } else {
        msg.style.color='crimson'; msg.textContent='Da ist noch etwas falsch. Fehler sind rot markiert.';
      }
    }

    function showLetter(letter){
      const container=document.getElementById('letter-container');
      document.getElementById('letter').textContent=letter;
      container.style.display='block';
    }
  </script>
</body>
</html>
