 <!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Wortsuppe â€“ Weihnachten (Bildersuche)</title>
  <style>
    :root{ --accent:#c54c3d; --found:#12884b; } /* <- krÃ¤ftigeres GrÃ¼n */

    /* ========================
       === HINTERGRUNDBILD-KONFIG (Editierbar) ===
       ======================== */
    :root{
      --bg-image: url('assets/buchstabensuppe.png');
      --bg-size:  cover;
      --bg-pos-x: 50%;
      --bg-pos-y: 50%;
      --bg-opacity: 0.8;
    }

    html,body{height:100%}
    body{
      margin:0; background:#f7efe6; color:#222;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      position:relative;
    }

    body::before{
      content:"";
      position:fixed; inset:0;
      background-image: var(--bg-image);
      background-repeat:no-repeat;
      background-size: var(--bg-size);
      background-position: var(--bg-pos-x) var(--bg-pos-y);
      opacity: var(--bg-opacity);
      z-index:0; pointer-events:none;
    }

    header, main{ position:relative; z-index:1; }

    header{ text-align:center; background:#c54c3d; color:#fff; padding:1rem .75rem; }
    header h1{ margin:0; font-size:2rem; }

    main{ max-width:1000px; margin:1rem auto 2rem; padding:1rem; }
    .wrap{ display:grid; grid-template-columns: min(92vw,520px) 1fr; gap:1rem; align-items:start; }
    @media (max-width:900px){ .wrap{ grid-template-columns:1fr; } }

    .card{
      background:rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.08);
      border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,.12);
      padding:1rem;
      backdrop-filter: blur(2px);
    }

    /* GRID */
    .grid{
      user-select:none; touch-action:none;
      display:grid; grid-template-columns:repeat(var(--size),1fr); grid-template-rows:repeat(var(--size),1fr);
      width:min(92vw,520px); aspect-ratio:1/1; background:#000; border-radius:12px; overflow:hidden;
    }
    .cell{
      display:flex; align-items:center; justify-content:center;
      font:700 1.05rem/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:#fff8ee; position:relative;
      box-shadow: inset 0 1px 0 rgba(0,0,0,.25), inset 1px 0 0 rgba(0,0,0,.25);
      transition: background .12s ease, box-shadow .12s ease, transform .12s ease, font-size .12s ease, color .12s ease, text-shadow .12s ease;
    }

    /* >>> Deutlichere Markierung fÃ¼r gefundene WÃ¶rter <<< */
    .cell.locked{
      background: var(--found);
      color:#fff;
      font-weight:900;
      text-shadow:0 1px 0 rgba(0,0,0,.25);
      box-shadow:
        inset 0 0 0 2px rgba(0,0,0,.18),
        0 0 0 3px rgba(18,136,75,.28);
      transform: scale(1.02);
      z-index:1;
      font-size:1.15rem;
    }

    @media (prefers-reduced-motion:no-preference){
      .cell.locked{ animation: foundPop .3s ease-out; }
      @keyframes foundPop{
        0%{ transform:scale(1.08); }
        100%{ transform:scale(1.02); }
      }
    }

    /* Auswahl/Vorschau */
    .cell.preview{
      background:#ffd9cc;
      box-shadow: inset 0 0 0 2px #ff936f;
    }
    .cell.current{
      background:#ffbe9f;
      box-shadow:
        inset 0 0 0 2px #ff6a3d,
        0 0 0 3px rgba(197,76,61,.15);
      transform: scale(1.02);
      z-index: 1;
      font-weight:900;
      text-shadow:0 1px 0 rgba(255,255,255,.7);
    }

    @media (max-width:700px){
      .cell{ font-size:1.2rem; }
      .cell.preview{ font-size:1.25rem; }
      .cell.current{ font-size:1.35rem; }
      .cell.locked{ font-size:1.3rem; }
    }

    /* Bilder-Tafel */
    .pics h2{ margin:.2rem 0 .6rem; }
    .hint{ font-size:.95rem; color:#555; margin:.25rem 0 .75rem; }
    .picgrid{
      display:grid; gap:.6rem;
      grid-template-columns: repeat(auto-fill, minmax(90px,1fr));
    }
    .pic{
      position:relative; aspect-ratio: 1/1;
      border:1px solid rgba(0,0,0,.12); border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      background:#fff;
      overflow:hidden;
    }
    .pic img{
      max-width:80%; max-height:80%; object-fit:contain;
      display:block;
      transition: filter .2s ease, transform .2s ease;
    }
    .pic .cap{ display:none !important; }

    .pic.found img{ filter: grayscale(1) brightness(0.9); transform: scale(0.96); }
    .pic.found::after{
      content:"âœ“"; position:absolute; top:6px; right:8px;
      background:var(--found); color:#fff; font-weight:900;
      width:24px; height:24px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 2px 6px rgba(0,0,0,.2);
    }

    .bar{ text-align:center; margin-top:.8rem; }
    .btn{
      appearance:none;border:none;cursor:pointer;background:var(--accent);color:#fff;
      padding:.6rem 1rem;border-radius:10px;font-weight:700;box-shadow:0 4px 14px rgba(0,0,0,.2);
    }
    .msg{ display:block; margin-top:.5rem; color:#333; font-weight:600; }
  </style>
</head>
<body>
  <header><h1>Wortsuppe â€“ Weihnachten (Bildersuche)</h1></header>

  <main>
    <div class="wrap">
      <section class="card">
        <div id="grid" class="grid" aria-label="Wortsuppe"></div>
      </section>

      <section class="card pics">
        <h2>Finde diese Bilder im Gitter</h2>
        <div class="hint">Nur <b>von links nach rechts</b> und <b>von oben nach unten</b> wischen.</div>
        <div id="picGrid" class="picgrid"></div>
        <div class="bar">
          <button class="btn" id="resetBtn">Neu mischen</button>
          <span class="msg" id="statusMsg"></span>
        </div>
      </section>
    </div>
  </main>

  <script>
    const IMAGES = [
      { word:"GESCHENK", src:"assets/gift.png"},
      { word:"DREIKOENIGE", src:"assets/drei_koenige.png"},
      { word:"NIKOLAUS", src:"assets/nikolaus.png"},
      { word:"RENTIER", src:"assets/reindeer.png"},
      { word:"SCHLITTEN", src:"assets/schlitten.png"},
      { word:"KERZE", src:"assets/candle.png"},
      { word:"TANNENBAUM", src:"assets/tree2.png"},
      { word:"KRIPPE", src:"assets/krippe.png"},
      { word:"STERN", src:"assets/stern.png"},
      { word:"KEKSE", src:"assets/kekse.png"},
      { word:"GLOCKEN", src:"assets/glocken.png"},
      { word:"SCHNEEMANN", src:"assets/snowman2.png"}
    ];
    const WORDS = IMAGES.map(i=>i.word);
    const SIZE = 15;
    const FILL = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    const gridEl = document.getElementById('grid');
    const picGridEl = document.getElementById('picGrid');
    const statusMsg = document.getElementById('statusMsg');
    const resetBtn = document.getElementById('resetBtn');

    function emptyGrid(){return Array.from({length:SIZE},()=>Array(SIZE).fill(null));}
    const DIRS=[[1,0],[0,1]];

    function tryPlace(grid,word){
      for(let t=0;t<300;t++){
        const [dx,dy]=DIRS[Math.floor(Math.random()*DIRS.length)];
        const len=word.length;
        const maxX=dx?SIZE-len:SIZE;
        const maxY=dy?SIZE-len:SIZE;
        const x0=Math.floor(Math.random()*maxX);
        const y0=Math.floor(Math.random()*maxY);
        let ok=true;
        for(let i=0;i<len;i++){
          const x=x0+dx*i,y=y0+dy*i;
          const c=grid[y][x];
          if(c&&c!==word[i]){ok=false;break;}
        }
        if(!ok)continue;
        for(let i=0;i<len;i++){grid[y0+dy*i][x0+dx*i]=word[i];}
        return true;
      }
      return false;
    }

    function buildGrid(words){
      const grid=emptyGrid();
      for(const w of words) tryPlace(grid,w.toUpperCase());
      for(let y=0;y<SIZE;y++)
        for(let x=0;x<SIZE;x++)
          if(!grid[y][x]) grid[y][x]=FILL[Math.floor(Math.random()*FILL.length)];
      return grid;
    }

    let data,foundWords;

    function renderGrid(){
      gridEl.style.setProperty('--size',SIZE);
      gridEl.innerHTML='';
      for(let y=0;y<SIZE;y++){
        for(let x=0;x<SIZE;x++){
          const d=document.createElement('div');
          d.className='cell';
          d.dataset.x=x;d.dataset.y=y;
          d.textContent=data[y][x];
          gridEl.appendChild(d);
        }
      }
    }

    function renderPictures(){
      picGridEl.innerHTML='';
      for(const it of IMAGES){
        const box=document.createElement('div');
        box.className='pic';box.id='pic_'+it.word;
        const img=document.createElement('img');
        img.src=it.src;img.alt=it.word;
        box.appendChild(img);
        picGridEl.appendChild(box);
      }
    }

    let selecting=false,startCell=null,previewEls=[],activePointerId=null,currentEl=null;
    function cellFromPoint(x,y){
      const el=document.elementFromPoint(x,y);
      const cell=el&&el.closest('.cell');
      return cell?{x:+cell.dataset.x,y:+cell.dataset.y,el:cell}:null;
    }
    function clearPreview(){
      previewEls.forEach(el=>el.classList.remove('preview'));
      previewEls=[];
      if(currentEl){currentEl.classList.remove('current');currentEl=null;}
    }
    function lineCells(x0,y0,x1,y1){
      const dx=Math.sign(x1-x0),dy=Math.sign(y1-y0);
      if((dx===1&&dy===0)||(dx===0&&dy===1)){
        const out=[];let x=x0,y=y0;
        while(true){out.push({x,y});if(x===x1&&y===y1)break;x+=dx;y+=dy;}
        return out;
      }
      return [];
    }
    function lettersOf(cells){return cells.map(({x,y})=>data[y][x]).join('');}
    function lockCells(cells){cells.forEach(({x,y})=>gridEl.children[y*SIZE+x].classList.add('locked'));}
    function markFound(w){
      foundWords.add(w);
      document.getElementById('pic_'+w)?.classList.add('found');
      statusMsg.textContent=`${foundWords.size}/${IMAGES.length} gefunden`;
    }
    function vibrate(ms){try{if(navigator.vibrate)navigator.vibrate(ms);}catch{}}

    function onDown(e){
      if(e.button!==undefined&&e.button!==0)return;
      const t=e.target.closest('.cell');if(!t)return;
      startCell={x:+t.dataset.x,y:+t.dataset.y,el:t};
      selecting=true;activePointerId=e.pointerId;
      clearPreview();
      t.classList.add('preview','current');
      previewEls=[t];currentEl=t;
      gridEl.setPointerCapture(activePointerId);
      vibrate(8);
      e.preventDefault();
    }
    function onMove(e){
      if(!selecting||e.pointerId!==activePointerId)return;
      const c=cellFromPoint(e.clientX,e.clientY)||startCell;
      previewEls.forEach(el=>el.classList.remove('preview'));
      previewEls=[];
      const cells=lineCells(startCell.x,startCell.y,c.x,c.y);
      for(const {x,y} of cells){
        const el=gridEl.children[y*SIZE+x];
        el.classList.add('preview');previewEls.push(el);
      }
      if(currentEl!==gridEl.children[c.y*SIZE+c.x]){
        currentEl?.classList.remove('current');
        currentEl=gridEl.children[c.y*SIZE+c.x];
        currentEl.classList.add('current');
      }
    }
    function onUp(e){
      if(!selecting||e.pointerId!==activePointerId)return;
      const c=cellFromPoint(e.clientX,e.clientY)||startCell;
      const cells=lineCells(startCell.x,startCell.y,c.x,c.y);
      const sel=lettersOf(cells);
      const match=WORDS.find(w=>!foundWords.has(w)&&w===sel);
      if(match){lockCells(cells);markFound(match);vibrate(25);}    
      clearPreview();selecting=false;gridEl.releasePointerCapture(activePointerId);
      if(foundWords.size===IMAGES.length)statusMsg.textContent='ðŸŽ‰ Alle Bilder gefunden!';
    }

    function addEvents(){
      gridEl.addEventListener('pointerdown',onDown,{passive:false});
      gridEl.addEventListener('pointermove',onMove,{passive:false});
      gridEl.addEventListener('pointerup',onUp,{passive:false});
      gridEl.addEventListener('pointercancel',onUp,{passive:false});
    }

    function init(){
      data=buildGrid(WORDS);foundWords=new Set();
      renderGrid();renderPictures();
      statusMsg.textContent=`0/${IMAGES.length} gefunden`;
    }

    resetBtn.addEventListener('click',init);
    addEvents();init();
  </script>
</body>
</html>
